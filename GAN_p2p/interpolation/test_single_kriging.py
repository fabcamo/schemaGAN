import numpy as np

# Generate spatial data
np.random.seed(123)
x = [108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511,
     108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511,
     108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511,
     108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511,
     108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511,
     108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511,
     108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511,
     108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511,
     108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511, 108, 190, 244, 316, 429, 511,
     108, 190, 316, 511, 108, 316, 511, 108, 316, 511, 108, 511, 108]
y = [ 0,  0,  0,  0,  0,  0,  1,  1,  1,  1,  1,  1, 2,  2, 2,  2,  2,  2,  3,  3,  3,  3,  3, 3,
  4,  4,  4,  4,  4,  4,  5,  5,  5,  5,  5,  5,  6,  6,  6,  6,  6,  6,  7,  7,  7,  7,  7,  7,
  8,  8,  8,  8,  8,  8,  9,  9,  9,  9,  9,  9, 10, 10, 10, 10 ,10, 10, 11, 11, 11, 11, 11, 11,
 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15,
 16, 16, 16, 16, 16, 16, 17, 17, 17, 17 ,17, 17, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19,
 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23,
 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 26, 26 ,26 ,26 ,26, 26, 27, 27, 27, 27, 28, 28,
 28, 29, 29, 29, 30, 30, 31]
z = [1.9273462295532227, 1.7242465019226074, 1.6158428192138672, 1.580024003982544, 1.4736183881759644, 1.6832295656204224, 1.9011478424072266, 1.718506932258606, 1.5938811302185059, 1.6977789402008057, 1.571814775466919, 1.6396492719650269, 1.8357635736465454, 1.7547473907470703, 1.63638174533844, 1.7766739130020142, 1.6524293422698975, 1.5666277408599854, 1.7664462327957153, 1.805112361907959, 1.733647346496582, 1.7813876867294312, 1.6798298358917236, 1.4865950345993042, 1.72380793094635, 1.8427400588989258, 1.8349575996398926, 1.7223886251449585, 1.6472437381744385, 1.4278587102890015, 1.7051318883895874, 1.8653396368026733, 1.8676159381866455, 1.6512506008148193, 1.5847384929656982, 1.4232648611068726, 1.7087959051132202, 1.8635855913162231, 1.8068808317184448, 1.6089146137237549, 1.5386278629302979, 1.4715583324432373, 1.734913945198059, 1.7928870916366577, 1.7180075645446777, 1.5758272409439087, 1.5387845039367676, 1.5420846939086914, 3.030557870864868, 3.2897403240203857, 3.249190330505371, 3.266792058944702, 3.2950870990753174, 3.3381152153015137, 3.245908737182617, 3.073094129562378, 3.450301170349121, 3.1931545734405518, 3.437246799468994, 3.0901219844818115, 3.0914053916931152, 3.235283851623535, 3.29473876953125, 3.3603155612945557, 3.3382668495178223, 3.3841395378112793, 3.4055778980255127, 3.3314967155456543, 3.257143020629883, 3.1470181941986084, 3.199484348297119, 3.270738363265991, 3.1477084159851074, 3.2321269512176514, 3.0503885746002197, 3.2665200233459473, 3.291996479034424, 3.4102299213409424, 3.181328535079956, 3.4159765243530273, 3.2099568843841553, 3.3304708003997803, 3.1129393577575684, 3.448742389678955, 3.262394666671753, 3.3723955154418945, 3.205287218093872, 3.355896234512329, 3.3483922481536865, 3.469111204147339, 1.6193026304244995, 3.3598620891571045, 3.267322540283203, 3.188840627670288, 3.597090005874634, 3.164076566696167, 1.5398322343826294, 3.2252001762390137, 3.390887498855591, 3.1196537017822266, 3.44539475440979, 3.406933307647705, 1.5684905052185059, 3.373866558074951, 3.2499725818634033, 3.356745958328247, 3.09051775932312, 3.273266077041626, 1.7283351421356201, 3.0237576961517334, 3.374354362487793, 3.2751541137695312, 3.119619846343994, 3.3361620903015137, 1.8503755331039429, 3.4916651248931885, 3.377795457839966, 3.2658791542053223, 3.2480781078338623, 3.2077159881591797, 1.8364429473876953, 1.4795674085617065, 3.1938159465789795, 3.410224676132202, 2.9707634449005127, 3.097954511642456, 1.7802960872650146, 1.5615601539611816, 3.199069023132324, 3.345536231994629, 3.0799925327301025, 3.3801653385162354, 1.7529455423355103, 1.6668145656585693, 1.608628749847412, 3.2803502082824707, 3.272141456604004, 3.2519800662994385, 1.7244898080825806, 1.725570559501648, 1.6065653562545776, 3.2271506786346436, 3.376837968826294, 3.3203604221343994, 1.6823785305023193, 1.690394401550293, 1.6498386859893799, 3.3195724487304688, 3.2370121479034424, 3.37414813041687, 1.641039252281189, 1.5692448616027832, 1.7372143268585205, 1.6773048639297485, 3.467219352722168, 3.2359778881073, 1.6092875003814697, 1.4652613401412964, 1.800007939338684, 3.20119309425354, 3.3982677459716797, 3.2054903507232666, 1.6103267669677734, 3.3366782665252686, 3.236949920654297, 3.3105971813201904, 3.2942066192626953, 3.2110228538513184, 3.386322021484375, 3.278067111968994, 3.139535665512085, 3.3950881958007812, 3.237210988998413, 3.402242422103882, 3.187577724456787]


from pykrige.ok import OrdinaryKriging

# Define the grid to interpolate onto
gridx = np.linspace(0, 512, 512)
gridy = np.linspace(0, 32, 32)

# Create the kriging object
OK = OrdinaryKriging(x, y, z, variogram_model='linear', nlags=10)
OK.display_variogram_model()

# Interpolate the data onto the grid
z_interp, _ = OK.execute('grid', gridx, gridy)

import matplotlib.pyplot as plt

# Create a plot of the original data
fig, ax = plt.subplots()
ax.scatter(x, y, c=z)
ax.set_title('Original Data')
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.invert_yaxis()
plt.show()

# Create a plot of the interpolated data
fig, ax = plt.subplots()
im = ax.imshow(z_interp, origin='lower', extent=(0, 512, 0, 32))
ax.scatter(x, y, c=z)
ax.set_title('Interpolated Data')
ax.set_xlabel('X')
ax.set_ylabel('Y')
ax.invert_yaxis()

fig.colorbar(im)
plt.show()
